name: GeraÃ§Ã£o de QuestÃµes com FLAN-T5 Pipeline

on:
  push:
    paths:
      - 'pdfreader/pdfs/**/*.pdf'
      - 'pdfreader/pdfs/**/*.md'
    branches:
      - main

jobs: 
  gerar_questoes: 
    runs-on: ubuntu-latest 
    env: 
      USE_OPENAI: false 
      OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}

steps:
  - name: ğŸ“¥ Checkout do repositÃ³rio
    uses: actions/checkout@v3

  - name: ğŸ¥ Configurar ambiente Python
    uses: actions/setup-python@v4
    with:
      python-version: '3.11'

  - name: ğŸ“¦ Instalar dependÃªncias
    run: |
      pip install transformers torch pdfplumber openai

  - name: ğŸ¤– Executar pipeline de questÃµes
    run: |
      for pdf in $(find pdfreader/pdfs -name '*.pdf'); do
        echo "Processando $pdf"
        python scripts/pipeline_main.py "$pdf" questions.json
      done

  - name: âœ… Mostrar resultado
    run: cat questions.json

  - name: ğŸ“„ Commit do questions.json
    run: |
      git config user.name "github-actions"
      git config user.email "actions@github.com"
      git add questions.json
      git commit -m "Atualiza questions.json com conteÃºdo gerado"
      git push
    continue-on-error: true

